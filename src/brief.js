import { getWeather } from './services/weather.js';\nimport { getNews } from './services/news.js';\nimport { getCalendarEvents } from './services/calendar.js';\n\n// Compose a personalized brief from sources and simple personalization rules.\nexport async function generateBrief(prefs) {\n  const { lat, lon, newsQuery, maxHeadlines, date } = prefs;\n\n  // Parallel fetches\n  const [weather, news, calendar] = await Promise.all([\n    getWeather({ lat, lon, date }),\n    getNews({ query: newsQuery, max: maxHeadlines }),\n    // calendar: optionally pass ICS_URL via env or prefs\n    getCalendarEvents({ icsUrl: process.env.ICS_URL || prefs.icsUrl, startDate: date, endDate: date })\n  ]);\n\n  // Simple personalization example: highlight umbrella if weathercode indicates rain\n  const rainCodes = [51, 53, 55, 61, 63, 65, 80, 81, 82];\n  const willRain = rainCodes.includes(Number(weather.weathercode));\n  const recommendations = [];\n  if (willRain) recommendations.push('Take an umbrella today.');\n  if (weather.temps.max && weather.temps.max >= 30) recommendations.push('It will be hot â€” stay hydrated.');\n\n  return {\n    date,\n    location: { lat, lon },\n    weather,\n    news,\n    calendar,\n    recommendations\n  };\n}\n