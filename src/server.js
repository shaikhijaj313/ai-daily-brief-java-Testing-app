import express from 'express';\nimport dotenv from 'dotenv';\nimport cron from 'node-cron';\nimport { generateBrief } from './brief.js';\ndotenv.config();\n\nconst app = express();\napp.use(express.json());\n\n// Simple endpoint to get a brief. In production, authenticate users.\app.get('/brief', async (req, res) => {\n  try {\n    // Basic personalization via query params (or fetch saved profile)\n    const prefs = {\n      lat: parseFloat(req.query.lat || process.env.DEFAULT_LAT),\n      lon: parseFloat(req.query.lon || process.env.DEFAULT_LON),\n      newsQuery: req.query.news || process.env.DEFAULT_NEWS_QUERY || 'general',\n      maxHeadlines: parseInt(req.query.maxHeadlines || '3', 10),\n      date: req.query.date || new Date().toISOString().slice(0, 10)\n    };\n    const brief = await generateBrief(prefs);\n    res.json(brief);\n  } catch (err) {\n    console.error(err);\n    res.status(500).json({ error: 'Failed to generate brief' });\n  }\n});\n\n// Optional: schedule a cron job to generate/send briefs (here every day at 07:00)\nif (process.env.SCHEDULED === 'true') {\n  cron.schedule(process.env.CRONTAB || '0 7 * * *', async () => {\n    try {\n      const prefs = {\n        lat: parseFloat(process.env.DEFAULT_LAT),\n        lon: parseFloat(process.env.DEFAULT_LON),\n        newsQuery: process.env.DEFAULT_NEWS_QUERY || 'general',\n        maxHeadlines: parseInt(process.env.MAX_HEADLINES || '3', 10),\n        date: new Date().toISOString().slice(0, 10)\n      };\n      const brief = await generateBrief(prefs);\n      // TODO: deliver via email/push/SMS\n      console.log('Scheduled brief:', JSON.stringify(brief, null, 2));\n    } catch (err) {\n      console.error('Scheduled job error', err);\n    }\n  }, { timezone: process.env.TIMEZONE || 'UTC' });\n}\n\nconst port = process.env.PORT || 3000;\app.listen(port, () => {\n  console.log(`Daily brief service listening on ${port}`);\n});\n